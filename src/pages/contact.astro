---
import Layout from '../layouts/Layout.astro';

const address = "Aalstersesteenweg 511A, 9400 Ninove";
const addressQuery = encodeURIComponent("Aalstersesteenweg 511A, 9400 Ninove, België");
const mapsDirectionsUrl = `https://www.google.com/maps/dir/?api=1&destination=${addressQuery}`;
const mapsEmbedUrl = `https://www.google.com/maps?q=${addressQuery}&output=embed`;
---

<Layout title="Contact – Steven Car Company BV" description="Contactgegevens en openingsuren. Bel 0487 45 03 31 of kom langs op afspraak. Aalstersesteenweg 511A, 9400 Ninove.">
  <div class="contact-page">
    <section class="contact-section">
      <div class="contact-container">
        <div class="contact-grid" id="contact-grid">
          <div class="contact-col contact-col-card" id="contact-col-card">
            <div class="contact-card">
              <h1 class="contact-title" id="contact-title">
                Contact
              </h1>

              <dl class="contact-dl">
                <div class="contact-dl-item" data-contact-item>
                  <dt class="contact-dt">Adres</dt>
                  <dd class="contact-dd">
                    Steven Car Company BV<br />
                    Aalstersesteenweg 511A<br />
                    9400 Ninove
                  </dd>
                </div>
                <div class="contact-dl-item" data-contact-item>
                  <dt class="contact-dt">Openingsuren</dt>
                  <dd class="contact-dd">
                    <table class="contact-table">
                      <tbody>
                        <tr class="contact-table-row">
                          <td class="contact-table-cell contact-table-label">Ma – vr</td>
                          <td class="contact-table-cell">08:00–12:00 en 12:30–19:30</td>
                        </tr>
                        <tr class="contact-table-row">
                          <td class="contact-table-cell contact-table-label">Za</td>
                          <td class="contact-table-cell">08:00–12:00 en 12:30–17:00</td>
                        </tr>
                        <tr class="contact-table-row">
                          <td class="contact-table-cell contact-table-label">Zo</td>
                          <td class="contact-table-cell">Gesloten</td>
                        </tr>
                      </tbody>
                    </table>
                  </dd>
                </div>
              </dl>

              <div class="contact-actions" id="contact-actions">
                <a href="tel:0487450331" class="contact-btn contact-btn-solid" data-contact-btn>
                  <svg class="contact-btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                  </svg>
                  Bel nu
                </a>
                <a
                  href={mapsDirectionsUrl}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="contact-btn contact-btn-ghost"
                  data-contact-btn
                >
                  <svg class="contact-btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
                  </svg>
                  Routebeschrijving
                </a>
              </div>

              <p class="contact-divider-t" id="contact-fb">
                <a
                  href="https://www.facebook.com/stevencarcompany"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="contact-fb-link"
                >
                  Volg ons op Facebook
                </a>
              </p>
            </div>
          </div>

          <div class="contact-col contact-col-map" id="contact-col-map">
            <div class="contact-map-wrap">
              <iframe
                title="Steven Car Company op Google Maps"
                src={mapsEmbedUrl}
                width="100%"
                height="100%"
                class="contact-map-iframe"
                allowfullscreen
                loading="lazy"
                referrerpolicy="no-referrer-when-downgrade"
              />
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <style is:global>
    /* —— Contact: wit · scherpe layout (zoals overname) —— */
    .contact-page {
      position: relative;
      min-height: 100%;
      background: #FFFFFF;
      color: #0a0a0a;
    }

    .contact-section {
      position: relative;
      z-index: 1;
      padding: 4rem 1.25rem 5rem;
    }
    @media (min-width: 640px) {
      .contact-section { padding: 5rem 2rem 6rem; }
    }
    @media (min-width: 1024px) {
      .contact-section { padding: 5rem 2.5rem 6rem; }
    }

    .contact-container {
      max-width: 72rem;
      margin-left: auto;
      margin-right: auto;
      padding-left: 0;
      padding-right: 0;
    }
    @media (min-width: 640px) {
      .contact-container { padding-left: 0; padding-right: 0; }
    }

    .contact-grid {
      display: grid;
      gap: 0;
      align-items: stretch;
      border: 1px solid rgba(0, 0, 0, 0.12);
    }
    @media (min-width: 1024px) {
      .contact-grid { grid-template-columns: 1fr 1fr; }
    }

    .contact-card {
      padding: 2rem;
      background: #FFFFFF;
      border: 1px solid rgba(0, 0, 0, 0.12);
      border-radius: 0;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    @media (max-width: 639px) {
      .contact-card {
        text-align: center;
        align-items: center;
      }
    }
    @media (min-width: 640px) {
      .contact-card { padding: 2.5rem; }
    }
    @media (min-width: 1024px) {
      .contact-card { border-right: 1px solid rgba(0, 0, 0, 0.12); border-bottom: none; }
    }

    .contact-title {
      font-family: var(--font-display);
      font-size: clamp(1.75rem, 4vw, 2.25rem);
      font-weight: 800;
      line-height: 1.05;
      letter-spacing: 0.08em;
      color: #0a0a0a;
      margin: 0;
      text-transform: uppercase;
    }

    .contact-dl {
      margin-top: 2rem;
      display: flex;
      flex-direction: column;
      gap: 0;
    }
    .contact-dl-item {
      border-bottom: 1px solid rgba(0, 0, 0, 0.12);
    }
    .contact-dl-item:last-of-type { border-bottom: none; }

    .contact-dt {
      font-family: var(--font-display);
      font-size: 0.6875rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #0a0a0a;
      padding-top: 1.25rem;
      padding-bottom: 0.5rem;
      margin: 0;
    }
    .contact-dd {
      font-family: var(--font-body);
      font-size: 0.9375rem;
      line-height: 1.5;
      color: #0a0a0a;
      margin: 0;
      padding-bottom: 1.25rem;
    }

    .contact-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9375rem;
    }
    .contact-table-row {
      border-bottom: 1px solid rgba(0, 0, 0, 0.12);
    }
    .contact-table-row:last-child { border-bottom: none; }
    .contact-table-cell {
      padding: 0.75rem 1rem 0.75rem 0;
      vertical-align: top;
      color: #0a0a0a;
    }
    .contact-table-label {
      font-family: var(--font-display);
      font-weight: 700;
      color: #0a0a0a;
    }
    @media (max-width: 639px) {
      .contact-table-row {
        display: block;
        padding: 0.5rem 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
      }
      .contact-table-row:last-child { border-bottom: none; }
      .contact-table-cell {
        display: block;
        padding: 0.125rem 0;
        text-align: inherit;
      }
      .contact-table-cell.contact-table-label {
        padding-bottom: 0.25rem;
      }
    }

    .contact-divider-t {
      margin: 0;
      padding-top: 1.5rem;
      margin-top: 2rem;
      border-top: 1px solid rgba(0, 0, 0, 0.12);
    }
    .contact-divider-t .contact-fb-link {
      font-size: 0.8125rem;
      color: #0a0a0a;
    }

    .contact-fb-link {
      display: inline-block;
      position: relative;
      text-decoration: none;
      color: #0a0a0a;
      transition: opacity 0.2s ease;
    }
    .contact-fb-link:hover { opacity: 0.75; }
    .contact-fb-link:focus-visible {
      outline: 1px solid #0a0a0a;
      outline-offset: 2px;
    }

    .contact-actions {
      margin-top: 2rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0;
      border-top: 1px solid rgba(0, 0, 0, 0.12);
      padding-top: 1.5rem;
    }
    @media (max-width: 639px) {
      .contact-actions {
        justify-content: center;
        gap: 0.5rem;
      }
      .contact-btn + .contact-btn { margin-left: 0; }
    }
    .contact-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      font-family: var(--font-display);
      font-weight: 700;
      font-size: 0.875rem;
      letter-spacing: 0.04em;
      padding: 0.875rem 1.5rem;
      border-radius: 0;
      text-decoration: none;
      transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
    }
    .contact-btn + .contact-btn { margin-left: -1px; }
    .contact-btn:focus-visible {
      outline: 1px solid #0a0a0a;
      outline-offset: 2px;
    }
    .contact-btn-icon { width: 1.25rem; height: 1.25rem; flex-shrink: 0; }

    .contact-btn-solid {
      background: #0a0a0a;
      color: #FFFFFF;
      border: 1px solid #0a0a0a;
    }
    .contact-btn-solid:hover {
      background: transparent;
      color: #0a0a0a;
      border-color: #0a0a0a;
    }

    .contact-btn-ghost {
      background: transparent;
      color: #0a0a0a;
      border: 1px solid rgba(0, 0, 0, 0.3);
    }
    .contact-btn-ghost:hover {
      border-color: #0a0a0a;
      color: #0a0a0a;
    }

    .contact-map-wrap {
      min-height: 320px;
      border-radius: 0;
      overflow: hidden;
      background: #f5f5f5;
      border: 1px solid rgba(0, 0, 0, 0.12);
      position: relative;
      transform-origin: center center;
    }
    @media (min-width: 640px) {
      .contact-map-wrap { min-height: 400px; }
    }
    @media (min-width: 1024px) {
      .contact-map-wrap { min-height: 0; height: 100%; border-left: none; border-top: none; }
    }
    .contact-map-iframe {
      width: 100%;
      height: 100%;
      min-height: 320px;
      border: 0;
      display: block;
      position: relative;
    }
    @media (min-width: 640px) {
      .contact-map-iframe { min-height: 400px; }
    }
    @media (min-width: 1024px) {
      .contact-map-iframe { min-height: 420px; }
    }
  </style>

  <script>
    import gsap from 'gsap';
    import { ScrollTrigger } from 'gsap/ScrollTrigger';

    gsap.registerPlugin(ScrollTrigger);

    function initContactAnimations() {
      const ease = 'power3.out';
      const card = document.getElementById('contact-col-card');
      const map = document.getElementById('contact-col-map');
      const mapWrap = document.querySelector('.contact-map-wrap');
      const title = document.getElementById('contact-title');
      const items = document.querySelectorAll('[data-contact-item]');
      const tableRows = document.querySelectorAll('.contact-table-row');
      const actions = document.getElementById('contact-actions');
      const btns = document.querySelectorAll('[data-contact-btn]');
      const btnIcons = document.querySelectorAll('.contact-btn-icon');
      const fb = document.getElementById('contact-fb');
      const fbLink = document.querySelector('.contact-fb-link');

      if (!card || !map) return;

      // —— Initial states ——
      gsap.set([card, map], { opacity: 0, y: 32, scale: 0.98 });
      if (mapWrap) {
        gsap.set(mapWrap, { scale: 1.05, opacity: 0, transformOrigin: 'center center' });
      }
      gsap.set(title, { opacity: 0, y: 20, rotationX: -8 });
      gsap.set(items, { opacity: 0, x: -20, scale: 0.96 });
      gsap.set(tableRows, { opacity: 0, x: -12 });
      gsap.set(actions, { opacity: 0, y: 16, scale: 0.98 });
      gsap.set(btns, { opacity: 0, y: 12, scale: 0.95 });
      gsap.set(btnIcons, { scale: 0, rotation: -180 });
      if (fb) gsap.set(fb, { opacity: 0, y: 8 });
      if (fbLink) gsap.set(fbLink, { opacity: 0, x: -8 });

      // —— Main timeline ——
      const tl = gsap.timeline({ defaults: { ease } });
      tl
        .to(card, { opacity: 1, y: 0, scale: 1, duration: 0.7 })
        .to(map, { opacity: 1, y: 0, scale: 1, duration: 0.7 }, '-=0.5')
        .to(mapWrap, { scale: 1, opacity: 1, duration: 0.8, transformOrigin: 'center center' }, '-=0.6')
        .to(title, { opacity: 1, y: 0, rotationX: 0, duration: 0.6 }, '-=0.6')
        .to(items, { opacity: 1, x: 0, scale: 1, duration: 0.5, stagger: 0.1 }, '-=0.4')
        .to(tableRows, { opacity: 1, x: 0, duration: 0.4, stagger: 0.06 }, '-=0.3')
        .to(actions, { opacity: 1, y: 0, scale: 1, duration: 0.45 }, '-=0.2')
        .to(btns, { opacity: 1, y: 0, scale: 1, duration: 0.4, stagger: 0.08 }, '-=0.35')
        .to(btnIcons, { scale: 1, rotation: 0, duration: 0.4, stagger: 0.08, ease: 'back.out(1.7)' }, '-=0.4');
      if (fb) tl.to(fb, { opacity: 1, y: 0, duration: 0.35 }, '-=0.2');
      if (fbLink) tl.to(fbLink, { opacity: 1, x: 0, duration: 0.4 }, '-=0.15');

      // —— Button hover animations ——
      btns.forEach((btn) => {
        const icon = btn.querySelector('.contact-btn-icon');
        const hoverTl = gsap.timeline({ paused: true });
        hoverTl
          .to(btn, { scale: 1.02, y: -2, duration: 0.2, ease: 'power2.out' })
          .to(icon, { rotation: 8, x: 2, duration: 0.2 }, 0);
        
        btn.addEventListener('mouseenter', () => hoverTl.play());
        btn.addEventListener('mouseleave', () => hoverTl.reverse());
      });

      // —— Facebook link hover ——
      if (fbLink) {
        const fbHoverTl = gsap.timeline({ paused: true });
        fbHoverTl.to(fbLink, { x: 4, duration: 0.2, ease: 'power2.out' });
        fbLink.addEventListener('mouseenter', () => fbHoverTl.play());
        fbLink.addEventListener('mouseleave', () => fbHoverTl.reverse());
      }

      // —— Scroll-triggered subtle effect for map (no vertical movement) ——
      if (mapWrap) {
        ScrollTrigger.create({
          trigger: mapWrap,
          start: 'top bottom',
          end: 'bottom top',
          scrub: 1,
          onUpdate: (self) => {
            const progress = self.progress;
            gsap.to(mapWrap, {
              scale: 1 + progress * 0.01,
              duration: 0.3,
              ease: 'none',
            });
          },
        });
      }

      // —— Card subtle scale on scroll ——
      ScrollTrigger.create({
        trigger: card,
        start: 'top 80%',
        end: 'bottom 20%',
        scrub: 0.5,
        onUpdate: (self) => {
          const progress = self.progress;
          gsap.to(card, {
            scale: 1 - progress * 0.01,
            duration: 0.3,
            ease: 'none',
          });
        },
      });

      // —— Title letter stagger (split text effect) ——
      if (title) {
        const titleText = title.textContent || '';
        title.innerHTML = titleText.split('').map((char, i) => 
          char === ' ' ? ' ' : `<span style="display: inline-block;">${char}</span>`
        ).join('');
        const titleLetters = title.querySelectorAll('span');
        gsap.set(titleLetters, { opacity: 0, y: 20, rotationX: -90 });
        gsap.to(titleLetters, {
          opacity: 1,
          y: 0,
          rotationX: 0,
          duration: 0.4,
          stagger: 0.03,
          delay: 0.3,
          ease: 'back.out(1.2)',
        });
      }
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initContactAnimations);
    } else {
      initContactAnimations();
    }
  </script>
</Layout>
